<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://projetointegradoradsfatec.github.io/pi-docs/python-cnn/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Sistema Inteligente - User Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">User Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../changes/" class="nav-link">Docs</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">API-Restful <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../api-restful/" class="dropdown-item">About</a>
</li>
                                    
<li>
    <a href="../api-restful/geoserver/" class="dropdown-item">Geoserver</a>
</li>
                                    
<li>
    <a href="../api-restful/db/" class="dropdown-item">Data Base</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../web-gis/" class="nav-link">Web-GIS</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Sistema Inteligente</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../web-gis/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/ProjetoIntegradorADSFatec/pi-docs/edit/master/docs/python-cnn/index.md" class="nav-link">Edit on docs-pi</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#python-convolutional-neural-networks" class="nav-link">Python Convolutional Neural Networks</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#ambiente-de-desenvolvimento" class="nav-link">Ambiente de Desenvolvimento</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#ambiente-de-micro-servicos-em-docker" class="nav-link">Ambiente de micro serviços em docker</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#codigo-fonte" class="nav-link">Código fonte</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="python-convolutional-neural-networks">Python Convolutional Neural Networks<a class="headerlink" href="#python-convolutional-neural-networks" title="Permanent link">&para;</a></h1>
<p><a href="https://docs.conda.io/en/latest/miniconda.html"><img alt="Miniconda" src="https://img.shields.io/badge/miniconda-3-green" /></a>
<a href="https://www.python.org/"><img alt="Python" src="https://img.shields.io/badge/python-3.8-green" /></a>
<a href="https://www.tensorflow.org/"><img alt="Tensorflow" src="https://img.shields.io/badge/tensorflow-2.1-green" /></a>
<a href="https://jupyter.org/"><img alt="JupyterLab" src="https://img.shields.io/badge/jupyter-1.0-green" /></a></p>
<p>O sistema deve reconhecer áreas de talhões (unidade mínima de cultivo de uma propriedade) em um mapa, utilizando dados multitemporais, através de inteligência artificial, a interface gráfica (Web GIS), deve permitir ao usuário selecionar um intervalo de tempo e as imagens de um catálogo disponível para a região selecionada, carregando-as em bloco para não sobrecarregar o sistema e ter opção para download.</p>
<p>Web GIS (Web Geographic Information System): Portal de um “Sistema de Informação Geográfica” (SIG), baseado em padrão de serviços web OGC, fornecendo uma estrutura para visualização e navegação de mapas (basemaps) e de dados geográficos vetoriais e matriciais.</p>
<ul>
<li>
<p>Catálogo de Imagem: O Catálogo de Imagem deve possibilitar a catalogação de coleções de dados espaço-temporal, (metadados) dos satélites Landsat 8 e Sentinel-2. Obs: O catálogo de imagem também deverá fornecer interface (web API) que permitirá consultar e recuperar as cenas de satélite catalogadas. Esta interface possibilitará que o Web GIS realize pesquisas complexas, filtrando diferentes parâmetros e especificando critérios geográficos.</p>
</li>
<li>
<p>Map Tile Engine: Esse componente deve produzir “map raster tile” para uma determinada cena de satélite, obedecendo ao padrão OGC WMTS. Permitindo que
usuários do Web GIS visualizem e naveguem pelas imagens sem precisar baixá-las (real time streaming). Cada map tile é uma representação visual de parte da imagem, não dos dados em si. Esses tiles geralmente são renderizados em formato pictórico (PNG ou JPEG) que podem ser exibidos em uma aplicação web.</p>
</li>
<li>
<p>Download: Após a consulta às imagens de uma determinada área de interesse, o sistema permite o download de todas as cenas (com todas as suas bandas) do período selecionado pelo usuário (Pilha de imagem).</p>
</li>
<li>
<p>Máscara (Mask): Neste módulo, o sistema gerará uma máscara binária com as regiões de interesse (AOI’s) para cada cena selecionada. A construção das máscaras de saída das áreas de interesse, se dão apresentando valor igual a um (1) dentro desse poligono, enquanto as demais áreas (áreas não selecionadas) apresentam valor igual a zero (0).</p>
</li>
</ul>
<p align = "center">
  <img width = "600px" src = "../assets/example.png">
</p>

<ul>
<li>Arquivo: Após a geração da máscara para cada cena (scene), é preciso armazená-la tanto para validação visual quanto para download. Com isso, nesse módulo a máscara deve ser armazenada de alguma forma que possibilite ao usuário fazer sua validação visual (próxima etapa), assim como o download para treinamento de modelos de inteligência artificial.</li>
</ul>
<blockquote>
<p>Funcionamento das redes neurais convolucionais para o processamento das imagens.</p>
</blockquote>
<p><strong>Obs.:</strong> Instalação do Miniconda é necessária para a execução dos comandos a seguir.</p>
<h2 id="ambiente-de-desenvolvimento">Ambiente de Desenvolvimento<a class="headerlink" href="#ambiente-de-desenvolvimento" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code># Montar no ambiente Linux
$ sudo apt-get update
$ sudo apt-get install python-numpy gdal-bin libgdal-dev

# Crie um novo ambiente conda com Python3+
$ conda create --name python-cnn python=3.6.9

# Ativar o ambiente
$ conda activate python-cnn

# Com o ambiente ativado instalar o ipykernel
(python-cnn) $ conda install notebook ipykernel

# Com o ipykernel criar um kernel com o python 3.5 automático
(python-cnn) $ ipython kernel install --user --name python-cnn

# Instalar o servidor Jupyter Lab
(python-cnn) $ python -m pip install jupyter

# Instalar a biblioteca gdal e basemap para processar as imagens
(python-cnn) $ conda install -c conda-forge gdal=2.4.4 decartes

# Executar o servidor em modo de desenvolvimento
(python-cnn) $ jupyter notebook
</code></pre></div>


<blockquote>
<p><strong>Obs.:</strong> Pode ser que o Notebook não  reconheça o kernel instalado pelo conda, sendo assim você pode alterar manualmente <code>kernel &gt;&gt; Change Kernel &gt;&gt; python-cnn</code>.</p>
</blockquote>
<h2 id="ambiente-de-micro-servicos-em-docker">Ambiente de micro serviços em docker<a class="headerlink" href="#ambiente-de-micro-servicos-em-docker" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code># Construir a imagem Docker
$ docker build -t jupyter-python-cnn .

# Executar a imagem
$ docker run --name jupyter-python-cnn-docker -p 8890:8888 -d jupyter-python-cnn
</code></pre></div>


<h2 id="codigo-fonte">Código fonte<a class="headerlink" href="#codigo-fonte" title="Permanent link">&para;</a></h2>
<blockquote>
<p>Também será necessário acesso ao servidores FTP:</p>
</blockquote>
<ul>
<li>
<p><a href="http://www.dpi.inpe.br/agricultural-database/lem/dados/cenas/Sentinel1">Sentinel-1 Data</a>;</p>
</li>
<li>
<p><a href="http://www.dpi.inpe.br/obt/agricultural-database/lem/dados/cenas/Sentinel2">Sentinel-2 Data</a>;</p>
</li>
<li>
<p><a href="http://www.dpi.inpe.br/obt/agricultural-database/lem/dados/cenas/Landsat8">Landsat-8 Data</a>;</p>
</li>
</ul>
<blockquote>
<p>Para a execução do código fonte abaixo é necessário o download da pasta <a href="https://fatecspgov-my.sharepoint.com/:u:/g/personal/abner_anjos_fatec_sp_gov_br/EaRDNhpRDGJMmSXc-AtoTDgBkG3G5tGBPvsdJBkeEOMSNw?e=fzM3V9"><code>data/</code></a>, após o download descompacte na pasta root do projeto.</p>
</blockquote>
<div class="codehilite"><pre><span></span><code>data/
    |_ input/
        |_ train/
            |_ false/
            |_ true/
        |_ validation/
            |_ br_uf/
            |_ false/
            |_ LEM_shapes/
            |_ true/
    |_ output/
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># !pip install tensorflow numpy matplotlib pillow wget rasterio geopandas</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">MaxPooling2D</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.image</span> <span class="kn">import</span> <span class="n">ImageDataGenerator</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># Abstração das buscas por polígonos e georasters</span>
<span class="kn">from</span> <span class="nn">services.georasters</span> <span class="kn">import</span> <span class="n">Georaster</span>
<span class="kn">from</span> <span class="nn">services.vector</span> <span class="kn">import</span> <span class="n">Vector</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="n">Georaster</span><span class="p">(</span><span class="s1">&#39;2017-06-12 08h:35m:46s&#39;</span><span class="p">,</span><span class="s1">&#39;vh&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">openRemoteFile</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>True
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">projection</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>&#39;EPSG:4326&#39;
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">downloadRemoteFile</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>True
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">convertFileToJPG</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>True
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">georaster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]], dtype=float32)
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">jpg</span>
</code></pre></div>


<p align = "center">
  <img width = "600px" src = "../assets/output_12_0.png">
</p>

<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">coords</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">georaster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">])][</span><span class="nb">int</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>-18.735785
-19.409836
-20.503849
-17.980326
-18.735785
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">shapes</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">4326</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">geom</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>{&#39;type&#39;: &#39;Polygon&#39;,
 &#39;coordinates&#39;: [[[-46.422421, -11.831513],
   [-46.426524, -12.598503],
   [-45.629512, -12.601568],
   [-45.627701, -11.834385],
   [-46.422421, -11.831513]]]}
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">data_geom</span> <span class="o">=</span> <span class="n">shapes</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">geom</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">data_geom</span>
</code></pre></div>


<p align = "left">
  <img width = "50px" src = "../assets/output_16_0.svg">
</p>

<div class="codehilite"><pre><span></span><code><span class="n">data</span><span class="o">.</span><span class="n">geom</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>{&#39;type&#39;: &#39;Polygon&#39;,
 &#39;coordinates&#39;: [[[-46.422421, -11.831513],
   [-46.426524, -12.598503],
   [-45.629512, -12.601568],
   [-45.627701, -11.834385],
   [-46.422421, -11.831513]]]}
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">shapes</span><span class="o">.</span><span class="n">lem</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NM_MUNICIP</th>
      <th>CD_GEOCMU</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>LUÃS EDUARDO MAGALHÃES</td>
      <td>2919553</td>
      <td>POLYGON ((-45.71038 -12.39706, -45.71422 -12.3...</td>
    </tr>
  </tbody>
</table>
</div>

<div class="codehilite"><pre><span></span><code><span class="n">shapes</span><span class="o">.</span><span class="n">covers</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>area_ha</th>
      <th>Jun_2017</th>
      <th>Jul_2017</th>
      <th>Aug_2017</th>
      <th>Sep_2017</th>
      <th>Oct_2017</th>
      <th>Nov_2017</th>
      <th>Dec_2017</th>
      <th>Jan_2018</th>
      <th>Feb_2018</th>
      <th>Mar_2018</th>
      <th>Apr_2018</th>
      <th>May_2018</th>
      <th>Jun_2018</th>
      <th>Geral</th>
      <th>variacao</th>
      <th>var</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>341.632515</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>xxxxxxxsssxxx</td>
      <td>xsx</td>
      <td>s</td>
      <td>POLYGON ((391870.392 8678209.011, 390327.395 8...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>523</td>
      <td>148.290258</td>
      <td>millet</td>
      <td>millet</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>not identified</td>
      <td>uncultivated soil</td>
      <td>not identified</td>
      <td>not identified</td>
      <td>uncultivated soil</td>
      <td>millet</td>
      <td>millet</td>
      <td>uncultivated soil</td>
      <td>llxxx-x--xllx</td>
      <td>lxlx</td>
      <td>ll</td>
      <td>POLYGON ((362953.448 8648254.537, 362492.885 8...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>196.784309</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>xxxxxxxsssxxx</td>
      <td>xsx</td>
      <td>s</td>
      <td>POLYGON ((394667.970 8677930.309, 394381.632 8...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>524</td>
      <td>28.625248</td>
      <td>sorghum</td>
      <td>sorghum</td>
      <td>sorghum</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>zzzxxxxsssxxx</td>
      <td>zxsx</td>
      <td>zs</td>
      <td>POLYGON ((378784.772 8650768.854, 378340.528 8...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>369.452478</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>soybean</td>
      <td>soybean</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>uncultivated soil</td>
      <td>xxxxxxxxssxxx</td>
      <td>xsx</td>
      <td>s</td>
      <td>POLYGON ((398795.097 8680743.662, 398796.144 8...</td>
    </tr>
  </tbody>
</table>
</div>

<div class="codehilite"><pre><span></span><code><span class="n">shapes</span><span class="o">.</span><span class="n">lem</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7440b11a20&gt;
</code></pre></div>


<p align = "center">
  <img width = "600px" src = "../assets/output_20_1.png">
</p>

<div class="codehilite"><pre><span></span><code><span class="n">shapes</span><span class="o">.</span><span class="n">covers</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7440ab0438&gt;
</code></pre></div>


<p align = "center">
  <img width = "600px" src = "../assets/output_21_1.png">
</p>

<div class="codehilite"><pre><span></span><code><span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="n">data</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">true</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>total 1751248
-rw-r--r-- 1 guilherme guilherme    297819 Jun 12 20:30 image10.jpg
-rw-r--r-- 1 guilherme guilherme      1194 Jun 12 20:30 image10.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589085 Jun  4  2018 image10.tif
-rw-r--r-- 1 guilherme guilherme   7300659 Jun 12 20:30 image11.jpg
-rw-r--r-- 1 guilherme guilherme      1206 Jun 12 20:30 image11.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme  58825766 Jun  4  2018 image11.tif
-rw-r--r-- 1 guilherme guilherme   8297339 Jun 12 20:30 image1.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:30 image1.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 228341788 May 14 11:18 image1.tif
-rw-r--r-- 1 guilherme guilherme   8064213 Jun 12 20:30 image2.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:30 image2.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 231710599 May 27 07:59 image2.tif
-rw-r--r-- 1 guilherme guilherme   9966359 Jun 12 20:30 image3.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:30 image3.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 228918854 May 11 17:15 image3.tif
-rw-r--r-- 1 guilherme guilherme   7532849 Jun 12 20:30 image4.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:30 image4.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 231557786 May 11 10:27 image4.tif
-rw-r--r-- 1 guilherme guilherme   7530780 Jun 12 20:30 image5.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:30 image5.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 228275958 May 11 10:27 image5.tif
-rw-r--r-- 1 guilherme guilherme    295697 Jun 12 20:30 image6.jpg
-rw-r--r-- 1 guilherme guilherme      1194 Jun 12 20:30 image6.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743705 Jun  4  2018 image6.tif
-rw-r--r-- 1 guilherme guilherme    274931 Jun 12 20:30 image7.jpg
-rw-r--r-- 1 guilherme guilherme      1172 Jun 12 20:30 image7.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743683 Jun  4  2018 image7.tif
-rw-r--r-- 1 guilherme guilherme   6144049 Jun 12 20:30 image8.jpg
-rw-r--r-- 1 guilherme guilherme      1206 Jun 12 20:30 image8.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme  58903076 Jun  4  2018 image8.tif
-rw-r--r-- 1 guilherme guilherme    273717 Jun 12 20:30 image9.jpg
-rw-r--r-- 1 guilherme guilherme      1172 Jun 12 20:30 image9.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589063 Jun  4  2018 image9.tif
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">convertAnyFileToJPG</span><span class="p">(</span><span class="s2">&quot;data/input/train/true/image</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converted Image </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Converted Image 1
Converted Image 2
Converted Image 3
Converted Image 4
Converted Image 5
Converted Image 6
Converted Image 7
Converted Image 8
Converted Image 9
Converted Image 10
Converted Image 11
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="n">data</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">false</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>total 1651376
-rw-r--r-- 1 guilherme guilherme   2871689 Jun 12 20:31 image10.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image10.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image10.tif
-rw-r--r-- 1 guilherme guilherme   3782439 Jun 12 20:31 image11.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image11.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image11.tif
-rw-r--r-- 1 guilherme guilherme   4025493 Jun 12 20:31 image12.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image12.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image12.tif
-rw-r--r-- 1 guilherme guilherme   5155462 Jun 12 20:31 image13.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image13.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image13.tif
-rw-r--r-- 1 guilherme guilherme   2997222 Jun 12 20:31 image14.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image14.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image14.tif
-rw-r--r-- 1 guilherme guilherme   1965034 Jun 12 20:30 image1.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:30 image1.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image1.tif
-rw-r--r-- 1 guilherme guilherme   2143385 Jun 12 20:30 image2.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:30 image2.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image2.tif
-rw-r--r-- 1 guilherme guilherme   2847540 Jun 12 20:31 image3.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image3.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image3.tif
-rw-r--r-- 1 guilherme guilherme   3999678 Jun 12 20:31 image4.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image4.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image4.tif
-rw-r--r-- 1 guilherme guilherme   4058218 Jun 12 20:31 image5.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image5.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image5.tif
-rw-r--r-- 1 guilherme guilherme   2764875 Jun 12 20:31 image6.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image6.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image6.tif
-rw-r--r-- 1 guilherme guilherme   2331207 Jun 12 20:31 image7.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image7.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image7.tif
-rw-r--r-- 1 guilherme guilherme   2215435 Jun 12 20:31 image8.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image8.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image8.tif
-rw-r--r-- 1 guilherme guilherme   2387198 Jun 12 20:31 image9.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:31 image9.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image9.tif
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">convertAnyFileToJPG</span><span class="p">(</span><span class="s2">&quot;data/input/train/false/image</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converted Image </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Converted Image 1
Converted Image 2
Converted Image 3
Converted Image 4
Converted Image 5
Converted Image 6
Converted Image 7
Converted Image 8
Converted Image 9
Converted Image 10
Converted Image 11
Converted Image 12
Converted Image 13
Converted Image 14
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">Rl</span> <span class="n">data</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">train</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>data/input/train:
total 1353008
-rw-r--r-- 1 guilherme guilherme 228341788 Jun 12 21:04 &#39;clip_20170612T083546_Sigma0_VH_db (1).tif&#39;
-rw-r--r-- 1 guilherme guilherme   8297339 Jun 12 21:04  clip_20170612T083546_Sigma0_VH_db.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 21:04  clip_20170612T083546_Sigma0_VH_db.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 228341788 May 14 11:18  clip_20170612T083546_Sigma0_VH_db.tif
-rw-rw-r-- 1 guilherme guilherme 231710599 May 27 07:59  clip_20170612T083546_Sigma0_VV_db.tif
-rw-rw-r-- 1 guilherme guilherme 228275958 May 11 10:27  clip_20170624T083547_Sigma0_VH_db.tif
-rw-rw-r-- 1 guilherme guilherme 231557786 May 11 10:27  clip_20170624T083547_Sigma0_VV_db.tif
-rw-r--r-- 1 guilherme guilherme 228918854 May 11 17:15  clip_20180315T083548_Sigma0_VH_db.tif
drwxr-xr-x 2 guilherme guilherme      4096 Jun 12 21:06  false
drwxr-xr-x 2 guilherme guilherme      4096 Jun 12 21:05  true

data/input/train/false:
total 1651376
-rw-r--r-- 1 guilherme guilherme   2871689 Jun 12 21:06 image10.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image10.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image10.tif
-rw-r--r-- 1 guilherme guilherme   3782439 Jun 12 21:06 image11.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image11.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image11.tif
-rw-r--r-- 1 guilherme guilherme   4025493 Jun 12 21:06 image12.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image12.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image12.tif
-rw-r--r-- 1 guilherme guilherme   5155462 Jun 12 21:06 image13.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image13.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image13.tif
-rw-r--r-- 1 guilherme guilherme   2997222 Jun 12 21:06 image14.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image14.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image14.tif
-rw-r--r-- 1 guilherme guilherme   1965034 Jun 12 21:05 image1.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:05 image1.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image1.tif
-rw-r--r-- 1 guilherme guilherme   2143385 Jun 12 21:05 image2.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:05 image2.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image2.tif
-rw-r--r-- 1 guilherme guilherme   2847540 Jun 12 21:05 image3.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:05 image3.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image3.tif
-rw-r--r-- 1 guilherme guilherme   3999678 Jun 12 21:05 image4.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:05 image4.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image4.tif
-rw-r--r-- 1 guilherme guilherme   4058218 Jun 12 21:05 image5.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:05 image5.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image5.tif
-rw-r--r-- 1 guilherme guilherme   2764875 Jun 12 21:06 image6.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image6.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image6.tif
-rw-r--r-- 1 guilherme guilherme   2331207 Jun 12 21:06 image7.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image7.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image7.tif
-rw-r--r-- 1 guilherme guilherme   2215435 Jun 12 21:06 image8.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image8.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image8.tif
-rw-r--r-- 1 guilherme guilherme   2387198 Jun 12 21:06 image9.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 21:06 image9.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image9.tif

data/input/train/true:
total 1751248
-rw-r--r-- 1 guilherme guilherme    297819 Jun 12 21:05 image10.jpg
-rw-r--r-- 1 guilherme guilherme      1194 Jun 12 21:05 image10.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589085 Jun  4  2018 image10.tif
-rw-r--r-- 1 guilherme guilherme   7300659 Jun 12 21:05 image11.jpg
-rw-r--r-- 1 guilherme guilherme      1206 Jun 12 21:05 image11.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme  58825766 Jun  4  2018 image11.tif
-rw-r--r-- 1 guilherme guilherme   8297339 Jun 12 21:04 image1.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 21:04 image1.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 228341788 May 14 11:18 image1.tif
-rw-r--r-- 1 guilherme guilherme   8064213 Jun 12 21:05 image2.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 21:05 image2.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 231710599 May 27 07:59 image2.tif
-rw-r--r-- 1 guilherme guilherme   9966359 Jun 12 21:05 image3.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 21:05 image3.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 228918854 May 11 17:15 image3.tif
-rw-r--r-- 1 guilherme guilherme   7532849 Jun 12 21:05 image4.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 21:05 image4.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 231557786 May 11 10:27 image4.tif
-rw-r--r-- 1 guilherme guilherme   7530780 Jun 12 21:05 image5.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 21:05 image5.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 228275958 May 11 10:27 image5.tif
-rw-r--r-- 1 guilherme guilherme    295697 Jun 12 21:05 image6.jpg
-rw-r--r-- 1 guilherme guilherme      1194 Jun 12 21:05 image6.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743705 Jun  4  2018 image6.tif
-rw-r--r-- 1 guilherme guilherme    274931 Jun 12 21:05 image7.jpg
-rw-r--r-- 1 guilherme guilherme      1172 Jun 12 21:05 image7.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743683 Jun  4  2018 image7.tif
-rw-r--r-- 1 guilherme guilherme   6144049 Jun 12 21:05 image8.jpg
-rw-r--r-- 1 guilherme guilherme      1206 Jun 12 21:05 image8.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme  58903076 Jun  4  2018 image8.tif
-rw-r--r-- 1 guilherme guilherme    273717 Jun 12 21:05 image9.jpg
-rw-r--r-- 1 guilherme guilherme      1172 Jun 12 21:05 image9.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589063 Jun  4  2018 image9.tif
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="n">data</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">validation</span><span class="o">/</span><span class="n">true</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>total 2104560
-rw-r--r-- 1 guilherme guilherme   7871698 Jun 12 20:31 image1.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:31 image1.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 230180639 May 27 15:27 image1.tif
-rw-r--r-- 1 guilherme guilherme   7862518 Jun 12 20:31 image2.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:31 image2.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 233288867 May 27 15:27 image2.tif
-rw-r--r-- 1 guilherme guilherme   8185099 Jun 12 20:31 image3.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:31 image3.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 230717127 May 27 15:24 image3.tif
-rw-r--r-- 1 guilherme guilherme   8318538 Jun 12 20:31 image4.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:31 image4.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 233672094 May 27 15:25 image4.tif
-rw-r--r-- 1 guilherme guilherme  10049028 Jun 12 20:32 image5.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:32 image5.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 228496143 May 27 15:19 image5.tif
-rw-r--r-- 1 guilherme guilherme  10357406 Jun 12 20:32 image6.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:32 image6.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 226850973 May 27 15:21 image6.tif
-rw-r--r-- 1 guilherme guilherme   9850587 Jun 12 20:32 image7.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:32 image7.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 229910342 May 27 15:21 image7.tif
-rw-r--r-- 1 guilherme guilherme  11412402 Jun 12 20:32 image8.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:32 image8.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 229693774 May 27 15:23 image8.tif
-rw-r--r-- 1 guilherme guilherme  11925993 Jun 12 20:32 image9.jpg
-rw-r--r-- 1 guilherme guilherme      1089 Jun 12 20:32 image9.jpg.aux.xml
-rw-rw-r-- 1 guilherme guilherme 226351595 May 27 15:23 image9.tif
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">convertAnyFileToJPG</span><span class="p">(</span><span class="s2">&quot;data/input/validation/true/image</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converted Image </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Converted Image 1
Converted Image 2
Converted Image 3
Converted Image 4
Converted Image 5
Converted Image 6
Converted Image 7
Converted Image 8
Converted Image 9
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="err">!</span><span class="n">ls</span> <span class="o">-</span><span class="n">l</span> <span class="n">data</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">validation</span><span class="o">/</span><span class="n">false</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>total 1660528
-rw-r--r-- 1 guilherme guilherme   3268609 Jun 12 20:33 image10.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image10.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image10.tif
-rw-r--r-- 1 guilherme guilherme   3263234 Jun 12 20:33 image11.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image11.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image11.tif
-rw-r--r-- 1 guilherme guilherme   3381101 Jun 12 20:33 image12.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image12.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image12.tif
-rw-r--r-- 1 guilherme guilherme   4546254 Jun 12 20:33 image13.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image13.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image13.tif
-rw-r--r-- 1 guilherme guilherme   4836100 Jun 12 20:33 image14.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image14.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image14.tif
-rw-r--r-- 1 guilherme guilherme   3240131 Jun 12 20:32 image1.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image1.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image1.tif
-rw-r--r-- 1 guilherme guilherme   3241932 Jun 12 20:32 image2.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image2.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image2.tif
-rw-r--r-- 1 guilherme guilherme   3366261 Jun 12 20:32 image3.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image3.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image3.tif
-rw-r--r-- 1 guilherme guilherme   3580752 Jun 12 20:32 image4.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image4.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image4.tif
-rw-r--r-- 1 guilherme guilherme   4218408 Jun 12 20:32 image5.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image5.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image5.tif
-rw-r--r-- 1 guilherme guilherme   4981837 Jun 12 20:32 image6.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image6.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image6.tif
-rw-r--r-- 1 guilherme guilherme   4651111 Jun 12 20:32 image7.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:32 image7.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117743711 Jun  4  2018 image7.tif
-rw-r--r-- 1 guilherme guilherme   3189797 Jun 12 20:33 image8.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image8.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image8.tif
-rw-r--r-- 1 guilherme guilherme   3152223 Jun 12 20:33 image9.jpg
-rw-r--r-- 1 guilherme guilherme      1195 Jun 12 20:33 image9.jpg.aux.xml
-rw-r--r-- 1 guilherme guilherme 117589091 Jun  4  2018 image9.tif
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">convertAnyFileToJPG</span><span class="p">(</span><span class="s2">&quot;data/input/validation/false/image</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Converted Image </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Converted Image 1
Converted Image 2
Converted Image 3
Converted Image 4
Converted Image 5
Converted Image 6
Converted Image 7
Converted Image 8
Converted Image 9
Converted Image 10
Converted Image 11
Converted Image 12
Converted Image 13
Converted Image 14
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">PATH</span> <span class="o">=</span> <span class="s2">&quot;data/input&quot;</span>
<span class="n">PATH</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>&#39;data/input&#39;
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">train_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
<span class="n">validation_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PATH</span><span class="p">,</span> <span class="s1">&#39;validation&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">train_false_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">train_dir</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>
<span class="n">train_true_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">train_dir</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>
<span class="n">validation_false_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">validation_dir</span><span class="p">,</span> <span class="s1">&#39;false&#39;</span><span class="p">)</span>
<span class="n">validation_true_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">validation_dir</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">num_false_tr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">train_false_dir</span><span class="p">))</span>
<span class="n">num_true_tr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">train_true_dir</span><span class="p">))</span>

<span class="n">num_false_val</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">validation_false_dir</span><span class="p">))</span>
<span class="n">num_true_val</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">validation_true_dir</span><span class="p">))</span>

<span class="n">total_train</span> <span class="o">=</span> <span class="n">num_false_tr</span> <span class="o">+</span> <span class="n">num_true_tr</span>
<span class="n">total_val</span> <span class="o">=</span> <span class="n">num_false_val</span> <span class="o">+</span> <span class="n">num_true_val</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total training false images:&#39;</span><span class="p">,</span> <span class="n">num_false_tr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total training true images:&#39;</span><span class="p">,</span> <span class="n">num_true_tr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total validation false images:&#39;</span><span class="p">,</span> <span class="n">num_false_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;total validation true images:&#39;</span><span class="p">,</span> <span class="n">num_true_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total training images:&quot;</span><span class="p">,</span> <span class="n">total_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total validation images:&quot;</span><span class="p">,</span> <span class="n">total_val</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>total training false images: 42
total training true images: 33
total validation false images: 42
total validation true images: 27
--
Total training images: 75
Total validation images: 69
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">IMG_HEIGHT</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">IMG_WIDTH</span> <span class="o">=</span> <span class="mi">150</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># Generator for our training data</span>
<span class="n">train_image_generator</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span>
    <span class="n">rescale</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span>
    <span class="n">horizontal_flip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Inverte a imagem</span>
    <span class="n">zoom_range</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>  <span class="c1"># Aplica zoom</span>
    <span class="n">rotation_range</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>  <span class="c1"># Rotaciona</span>
    <span class="n">width_shift_range</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Estica horizontalmente a imagem</span>
    <span class="n">height_shift_range</span><span class="o">=.</span><span class="mi">11</span><span class="p">,</span>  <span class="c1"># Estica verticalmente a imagem</span>
<span class="p">)</span>
<span class="c1"># Vale ressaltar que estas modificações nas imagens ocorrem durante as epochs</span>
<span class="c1"># e ajudam a evitar que o modelo tenha sido treinado com duas imagens iguais</span>
<span class="c1"># Então, teoricamente possuímos mais imagens de teste</span>

<span class="c1"># Generator for our validation data</span>
<span class="n">validation_image_generator</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span><span class="n">rescale</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">train_data_gen</span> <span class="o">=</span> <span class="n">train_image_generator</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">directory</span><span class="o">=</span><span class="n">train_dir</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">IMG_HEIGHT</span><span class="p">,</span> <span class="n">IMG_WIDTH</span><span class="p">),</span>
    <span class="n">class_mode</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span>
<span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Found 50 images belonging to 2 classes.
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">val_data_gen</span> <span class="o">=</span> <span class="n">validation_image_generator</span><span class="o">.</span><span class="n">flow_from_directory</span><span class="p">(</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">directory</span><span class="o">=</span><span class="n">validation_dir</span><span class="p">,</span>
    <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">IMG_HEIGHT</span><span class="p">,</span> <span class="n">IMG_WIDTH</span><span class="p">),</span>
    <span class="n">class_mode</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span>
<span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Found 46 images belonging to 4 classes.
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">sample_training_images</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_data_gen</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="c1"># This function will plot images in the form of</span>
<span class="c1"># a grid with 1 row and 5 columns where images are placed in each column.</span>
<span class="k">def</span> <span class="nf">plotImages</span><span class="p">(</span><span class="n">images_arr</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">img</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">images_arr</span><span class="p">,</span> <span class="n">axes</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">plotImages</span><span class="p">(</span><span class="n">sample_training_images</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</code></pre></div>


<p align = "center">
  <img src = "../assets/output_42_0.png">
</p>

<div class="codehilite"><pre><span></span><code><span class="n">augmented_images</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_data_gen</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">plotImages</span><span class="p">(</span><span class="n">augmented_images</span><span class="p">)</span>
</code></pre></div>


<p align = "center">
  <img src = "../assets/output_44_0.png">
</p>

<div class="codehilite"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
    <span class="n">Conv2D</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">IMG_HEIGHT</span><span class="p">,</span> <span class="n">IMG_WIDTH</span> <span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
    <span class="n">MaxPooling2D</span><span class="p">(),</span>
    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
    <span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">MaxPooling2D</span><span class="p">(),</span>
    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">MaxPooling2D</span><span class="p">(),</span>
    <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">(),</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
    <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
    <span class="n">loss</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">BinaryCrossentropy</span><span class="p">(</span><span class="n">from_logits</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Model: &quot;sequential&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 150, 150, 16)      448
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 75, 75, 16)        0
_________________________________________________________________
dropout (Dropout)            (None, 75, 75, 16)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 75, 75, 32)        4640
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 37, 37, 32)        0
_________________________________________________________________
dropout_1 (Dropout)          (None, 37, 37, 32)        0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 37, 37, 64)        18496
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 18, 18, 64)        0
_________________________________________________________________
dropout_2 (Dropout)          (None, 18, 18, 64)        0
_________________________________________________________________
flatten (Flatten)            (None, 20736)             0
_________________________________________________________________
dense (Dense)                (None, 512)               10617344
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 513
=================================================================
Total params: 10,641,441
Trainable params: 10,641,441
Non-trainable params: 0
_________________________________________________________________
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit_generator</span><span class="p">(</span>
    <span class="n">train_data_gen</span><span class="p">,</span>
    <span class="n">steps_per_epoch</span><span class="o">=</span><span class="n">total_val</span> <span class="o">//</span> <span class="n">batch_size</span><span class="p">,</span>  <span class="c1"># total_train</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
    <span class="n">validation_data</span><span class="o">=</span><span class="n">val_data_gen</span><span class="p">,</span>
    <span class="n">validation_steps</span><span class="o">=</span><span class="n">total_val</span> <span class="o">//</span> <span class="n">batch_size</span>
<span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>WARNING:tensorflow:From &lt;ipython-input-48-bc7c196dd375&gt;:6: Model.fit_generator (from tensorflow.python.keras.engine.training) is deprecated and will be removed in a future version.
Instructions for updating:
Please use Model.fit, which supports generators.
Epoch 1/4
4/4 [==============================] - 153s 38s/step - loss: 1.3653 - accuracy: 0.6000 - val_loss: 0.1966 - val_accuracy: 0.0000e+00
Epoch 2/4
4/4 [==============================] - 144s 36s/step - loss: 0.6799 - accuracy: 0.5250 - val_loss: 1.2178 - val_accuracy: 0.0000e+00
Epoch 3/4
4/4 [==============================] - 151s 38s/step - loss: 0.5490 - accuracy: 0.5500 - val_loss: 1.1076 - val_accuracy: 0.0000e+00
Epoch 4/4
4/4 [==============================] - 158s 40s/step - loss: 0.5802 - accuracy: 0.6000 - val_loss: 0.8831 - val_accuracy: 0.0000e+00
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
<span class="n">val_acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">]</span>
<span class="n">loss</span><span class="o">=</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
<span class="n">val_loss</span><span class="o">=</span><span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">epochs_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs_range</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs_range</span><span class="p">,</span> <span class="n">val_acc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and Validation Accuracy&#39;</span><span class="p">)</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code>Text(0.5, 1.0, &#39;Training and Validation Accuracy&#39;)
</code></pre></div>


<p align = "center">
  <img src = "../assets/output_51_1.png">
</p>

<div class="codehilite"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs_range</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs_range</span><span class="p">,</span> <span class="n">val_loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and Validation Loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>


<p align = "center">
  <img src = "../assets/output_52_0.png">
</p>

<div class="codehilite"><pre><span></span><code>
</code></pre></div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2020 Fatec SP.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
